plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:119,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:118,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:118,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 118,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:118,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
gc()
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
gc()
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
path_dataset <- "../../mit-bih-db.csv"
path_atr <- "../../atr_completo.csv"
# Caricamento
df_signal <- carica_e_pulisci_dati(path_dataset)
library(data.table)
library(ggplot2)
# --- 2. Esecuzione Main ---
path_dataset <- "../../mit-bih-db.csv"
path_atr <- "../../atr_completo.csv"
# Caricamento
df_signal <- carica_e_pulisci_dati(path_dataset)
df_atr <- fread(path_atr)
# Assicuriamoci che siano data.table e ordinati
setDT(df_signal)
setDT(df_atr)
setorder(df_signal, Partecipante, Sample)
# Preview Dati
cat("\n--- HEAD SIGNAL DATASET ---\n")
print(head(df_signal))
cat("\n--- HEAD ATR DATASET ---\n")
print(head(df_atr))
# Correzione Canali
df_signal <- esegui_correzioni_canali(df_signal)
# Inizializzazione Annotazioni (Picco e Label)
# Uniamo le informazioni in un passaggio efficiente
df_signal[, `:=` (Picco = FALSE)]
# Mapping dei picchi basato su Sample_Index
# Nota: Si assume corrispondenza riga-indice
if(max(df_atr$Sample_Index) <= nrow(df_signal)) {
df_signal[df_atr$Sample_Index, Picco := TRUE]
}
print(unique(df_signal$Label))
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 150:155,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:118,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
# Definizione parametri plot (usati per entrambi i grafici)
id_target <- 102
samples_target <- c(4, 5, 6) # Nota: intervallo molto stretto come da input
# Plot 1: Prima della correzione
cat("\nGenerazione Plot 1 (Pre-correzione)...\n")
plot1 <- genera_plot_segmento(df_signal, id_target, samples_target,
"Verifica Segmentazione - Pre Correzione")
print(plot1)
# Refining dei picchi
cat("\nEsecuzione correzione picchi locali...\n")
df_signal <- correggi_picchi_locali(df_signal, raggio = 18)
cat("Correzione completata.\n")
# Plot 2: Dopo la correzione
cat("\nGenerazione Plot 2 (Post-correzione)...\n")
plot2 <- genera_plot_segmento(df_signal, id_target, samples_target,
"Verifica Segmentazione - Post Correzione")
print(plot2)
print(unique(df_signal$Label))
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:118,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
# Plot 1: Prima della correzione
cat("\nGenerazione Plot 1 (Pre-correzione)...\n")
plot1 <- genera_plot_segmento(df_signal, id_target, samples_target,
"Verifica Segmentazione - Pre Correzione")
print(plot1)
# Refining dei picchi
cat("\nEsecuzione correzione picchi locali...\n")
df_signal <- correggi_picchi_locali(df_signal, raggio = 18)
cat("Correzione completata.\n")
# Plot 2: Dopo la correzione
cat("\nGenerazione Plot 2 (Post-correzione)...\n")
plot2 <- genera_plot_segmento(df_signal, id_target, samples_target,
"Verifica Segmentazione - Post Correzione")
print(plot2)
print(unique(df_signal$Label))
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 150:155,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
# Definizione parametri plot (usati per entrambi i grafici)
id_target <- 103
samples_target <- c(4, 5, 6) # Nota: intervallo molto stretto come da input
# Plot 1: Prima della correzione
cat("\nGenerazione Plot 1 (Pre-correzione)...\n")
plot1 <- genera_plot_segmento(df_signal, id_target, samples_target,
"Verifica Segmentazione - Pre Correzione")
print(plot1)
# Refining dei picchi
cat("\nEsecuzione correzione picchi locali...\n")
df_signal <- correggi_picchi_locali(df_signal, raggio = 18)
cat("Correzione completata.\n")
# Plot 2: Dopo la correzione
cat("\nGenerazione Plot 2 (Post-correzione)...\n")
plot2 <- genera_plot_segmento(df_signal, id_target, samples_target,
"Verifica Segmentazione - Post Correzione")
print(plot2)
print(unique(df_signal$Label))
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 150:155,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
# Definizione parametri plot (usati per entrambi i grafici)
id_target <- 104
samples_target <- c(4, 5, 6) # Nota: intervallo molto stretto come da input
# Plot 1: Prima della correzione
cat("\nGenerazione Plot 1 (Pre-correzione)...\n")
plot1 <- genera_plot_segmento(df_signal, id_target, samples_target,
"Verifica Segmentazione - Pre Correzione")
print(plot1)
# Refining dei picchi
cat("\nEsecuzione correzione picchi locali...\n")
df_signal <- correggi_picchi_locali(df_signal, raggio = 18)
cat("Correzione completata.\n")
# Plot 2: Dopo la correzione
cat("\nGenerazione Plot 2 (Post-correzione)...\n")
plot2 <- genera_plot_segmento(df_signal, id_target, samples_target,
"Verifica Segmentazione - Post Correzione")
print(plot2)
print(unique(df_signal$Label))
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 150:155,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:2000,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:1000,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:500,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:200,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 100:200,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 100:150,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:2,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:4,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:10,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 10:20,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 20:40,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:5,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
print(mean(df_signal$MLII))
print(mean(df_signal[Partecipante == 102]$MLII))
print(mean(df_signal[Partecipante == 102]$MLII))
df_signal[Partecipante == 102]$MLII <- df_signal[Partecipante]$MLII + mean(df_signal[Partecipante == 102]$MLII)
print(mean(df_signal[Partecipante == 102]$MLII))
df_signal[Partecipante == 102]$MLII <- df_signal[Partecipante == 102]$MLII + mean(df_signal[Partecipante == 102]$MLII)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:5,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
print(mean(df_signal[Partecipante == 102]$MLII))
df_signal[Partecipante == 102]$MLII <- df_signal[Partecipante == 102]$MLII - mean(df_signal[Partecipante == 102]$MLII)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:5,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:119,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:2000,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 1:3400,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 100:200,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 104,           # UN solo paziente
samples = 100:200,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 104,           # UN solo paziente
samples = 175:200,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 104,           # UN solo paziente
samples = 175:180,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
View(df_signal)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 104,           # UN solo paziente
samples = 175,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 104,           # UN solo paziente
samples = 175:180,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
cat("Correzione completata.\n")
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:118,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:119,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
View(df_atr)
path_dataset <- "../../mit-bih-db.csv"
path_atr <- "../../atr_completo.csv"
# Caricamento
df_signal <- carica_e_pulisci_dati(path_dataset)
df_atr <- fread(path_atr)
# Assicuriamoci che siano data.table e ordinati
setDT(df_signal)
setDT(df_atr)
setorder(df_signal, Partecipante, Sample)
# Preview Dati
cat("\n--- HEAD SIGNAL DATASET ---\n")
print(head(df_signal))
cat("\n--- HEAD ATR DATASET ---\n")
print(head(df_atr))
# Correzione Canali
df_signal <- esegui_correzioni_canali(df_signal)
# Inizializzazione Annotazioni (Picco e Label)
# Uniamo le informazioni in un passaggio efficiente
df_signal[, `:=` (Picco = FALSE)]
# Mapping dei picchi basato su Sample_Index
# Nota: Si assume corrispondenza riga-indice
if(max(df_atr$Sample_Index) <= nrow(df_signal)) {
df_signal[df_atr$Sample_Index, Picco := TRUE]
}
df_signal <- centra_segnale_mediana(df_signal)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:119,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 234,           # UN solo paziente
samples = 1:2000,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
path_dataset <- "../../mit-bih-db.csv"
path_atr <- "../../atr_completo.csv"
# Caricamento
df_signal <- carica_e_pulisci_dati(path_dataset)
df_atr <- fread(path_atr)
# Assicuriamoci che siano data.table e ordinati
setDT(df_signal)
setDT(df_atr)
setorder(df_signal, Partecipante, Sample)
# Preview Dati
cat("\n--- HEAD SIGNAL DATASET ---\n")
print(head(df_signal))
cat("\n--- HEAD ATR DATASET ---\n")
print(head(df_atr))
# Correzione Canali
df_signal <- esegui_correzioni_canali(df_signal)
# Inizializzazione Annotazioni (Picco e Label)
# Uniamo le informazioni in un passaggio efficiente
df_signal[, `:=` (Picco = FALSE)]
# Mapping dei picchi basato su Sample_Index
# Nota: Si assume corrispondenza riga-indice
if(max(df_atr$Sample_Index) <= nrow(df_signal)) {
df_signal[df_atr$Sample_Index, Picco := TRUE]
}
View(df_signal)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 234,           # UN solo paziente
samples = 1:2000,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 234,           # UN solo paziente
samples = 1:1000,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
# Conta le righe dove la colonna Partecipante Ã¨ uguale a 234
n_righe_234 <- df_signal[Partecipante == 234, .N]
cat("Il paziente 234 ha esattamente:", n_righe_234, "righe (campioni).\n")
cat("Il paziente 234 ha esattamente:", n_righe_234, "righe (campioni).\n")
print(unique( df_signal[Partecipante == 234, Sample]))
print(plot2)
print(max(unique( df_signal[Partecipante == 234, Sample])))
View(df_signal)
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
plot3 <- genera_plot_segmento(
df_signal,
id_paziente = 102,           # UN solo paziente
samples = 117:119,            # Un intervallo specifico, NON unique(df$Sample)
titolo = "Verifica Segmentazione - Post Correzione (Zoom)"
)
print(plot3)
View(df_atr)
View(df_signal)
path_dataset <- "../../mit-bih-db.csv"
path_atr <- "../../atr_completo.csv"
# Caricamento
df_signal <- carica_e_pulisci_dati(path_dataset)
df_atr <- fread(path_atr)
View(df_signal)
# Assicuriamoci che siano data.table e ordinati
setDT(df_signal)
setDT(df_atr)
setorder(df_signal, Partecipante, Sample)
# Preview Dati
cat("\n--- HEAD SIGNAL DATASET ---\n")
print(head(df_signal))
cat("\n--- HEAD ATR DATASET ---\n")
print(head(df_atr))
# Correzione Canali
df_signal <- esegui_correzioni_canali(df_signal)
# Inizializzazione Annotazioni (Picco e Label)
# Uniamo le informazioni in un passaggio efficiente
df_signal[, `:=` (Picco = FALSE)]
# Mapping dei picchi basato su Sample_Index
# Nota: Si assume corrispondenza riga-indice
if(max(df_atr$Sample_Index) <= nrow(df_signal)) {
df_signal[df_atr$Sample_Index, Picco := TRUE]
}
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/progetto/mit-bih-db/mit-bih-db/mit-bih-db.R")
source("~/Desktop/1 anno magistrale/Statistica e Analisi dei Dati/mit-bih-db/mit-bih-db.R")
